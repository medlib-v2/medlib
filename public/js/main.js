!function(e){function s(s){s.preventDefault();var t=e(this),n=t.data("username"),a=t.data("token"),r=t.attr("href"),i=t.data("method")||"POST",o=t.attr("class");return t.closest(".panel-default").find(".img-circle").attr("src")||t.closest(".profile-userpic").find(".img-circle").attr("src"),e.ajax({type:i,url:r,data:{username:n,_token:a}}).done(function(s){if("success"==s.response)switch(o){case"btn btn-success add-friend-request-button":t.empty(),t.append('<i class="fa fa-check-circle fa-fw"></i>&nbsp;Requested'),t.attr("disabled","disabled"),Messenger().post({message:s.message,type:"success",showCloseButton:!0});break;case"btn btn-primary btn-success accept-friend-button btn-sm":t.empty(),t.append('<i class="fa fa-check-circle fa-fw"></i>&nbsp;Friend added'),t.attr("disabled","disabled"),Messenger().post({message:s.message,type:"success",showCloseButton:!0}),t.closest(".panel-default").parents(".item").fadeOut(300),0==s.count&&t.parents(".col-md-12").append('<div class="alert alert-info" role="alert"><span class="glyphicon glyphicon-info-sign"></span> You don\'t have any friend requests.</div>');break;case"btn btn-primary btn-danger del-friend-button btn-sm":t.closest(".panel-default").parents(".item").fadeOut(300),Messenger().post({message:s.message,type:"success",showCloseButton:!0}),0==s.count&&t.parents(".col-md-12").append('<div class="alert alert-info" role="alert"><span class="glyphicon glyphicon-info-sign"></span> You don\'t have any friend requests.</div>');break;case"btn btn-danger del-friend-button":t.removeClass(),t.addClass("btn btn-success send-friend-request-button"),t.attr("href",r+"/requests"),t.attr("data-method","POST"),t.data("method","POST"),t.empty(),t.append('<i class="fa fa-check-circle fa-fw"></i>&nbsp;Add friend');break;case"btn btn-success send-friend-request-button":t.empty(),t.append('<i class="fa fa-check-circle fa-fw"></i>&nbsp;Requested'),t.attr("disabled","disabled"),Messenger().post({message:s.message,type:"success",showCloseButton:!0});break;case"btn btn-primary unfriend-button-3 btn-sm":t.closest(".listed-object-close").slideUp(),e("a[data-username="+t.attr("data-username")+"]").hide("slide",{direction:"right"},300),0==s.count&&(e(".users-list").append('<div class="alert alert-info" role="alert"><span class="glyphicon glyphicon-info-sign"></span> You don\'t have any friends.</div>'),e("#friend-side-list").hide(),e("#friend-list").append('<div class="alert alert-info" role="alert"><span class="glyphicon glyphicon-info-sign"></span> You don\'t have any friends.</div>'));var n=e(".friends-count").text(),a=parseInt(n)-1;e(".friends-count").text(a);break;case"logout-link":e("#no-friend-chat-alert").is(":visible")?window.location.replace("/"):(e(".side-list").each(function(){var s=e(this).attr("data-username");sessionStorage.removeItem("conversation-with-"+s)}),window.location.replace("/"))}else"failed"==s.response?Messenger().post({message:s.message,type:"error",showCloseButton:!0}):Messenger().post({message:"Something went wrong. Please try again.",type:"error",showCloseButton:!0})}).fail(function(e){"failed"==e.response&&Messenger().post({message:e.message,type:"error",showCloseButton:!0}),console.log(e),Messenger().post({message:"Something went wrong. Please try again.",type:"error",showCloseButton:!0})}),!1}e(".add-friend-request-button").click(s),e(".users-list").on("click",".accept-friend-button",s),e(".users-list").on("click",".del-friend-button",s),e(".profile-userpic").on("click",".send-friend-request-button",s),e(".profile-userpic").on("click",".del-friend-button",s)}(jQuery);