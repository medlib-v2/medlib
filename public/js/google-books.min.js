!function(e,t){function n(t,n,i){if(e.isFunction(i)||(i=n,n={}),n=e.extend({},s,n),a=n.rootUrl+"/"+n.apiName+"/"+n.apiVersion+"/"+n.resourcePath,!t)return i(new Error("Query is required"));if(n.offset<0)return i(new Error("Offset cannot be below 0"));if(n.limit<1||n.limit>1)return i(new Error("Limit must be 1"));t=n.fields?p[n.field]+t:p.isbn+t;var r={q:t,startIndex:n.offset,maxResults:n.limit,printType:n.type,orderBy:n.order,jscmd:"viewapi"};e.getJSON(a,r,function(e,n){var r;return r="success"===n&&0!==e.totalItems?o(e):{error:new Error("No Books found with isbn : "+t)},i(r,n)})}function i(e){if("string"==typeof e||"number"==typeof e){if(!c.test(e))return!1;e=e.toString().replace(/[- ]|^ISBN(?:-1[03])?:?/g,"").split("");var t=e.pop();if(e.length<9||e.length>10)return!1;e.reverse();for(var n=0;n<e.length;n++)l+=(n+2)*parseInt(e[n],f);return u=11-l%11,10==u?u="X":11==u&&(u="0"),u==t}return!1}function r(e){if("string"==typeof e||"number"==typeof e){if(!c.test(e))return!1;e=e.toString().replace(/[- ]|^ISBN(?:-1[03])?:?/g,"").split("");var t=e.pop();if(e.length<12||e.length>13)return!1;for(var n=0;n<e.length;n++)l+=(n%2*2+1)*parseInt(e[n],f);return u=(10-l%10)%10,u==t}return!1}function o(e){var t=e.items.map(function(e){var t=_.pick(e.volumeInfo,["title","subtitle","authors","publisher","publishedDate","description","industryIdentifiers","pageCount","printType","categories","averageRating","ratingsCount","maturityRating","language"]);return _.extend(t,{id:e.id,link:e.volumeInfo.canonicalVolumeLink,thumbnail:_.get(e,"volumeInfo.imageLinks.thumbnail"),images:_.pick(e.volumeInfo.imageLinks,["small","medium","large","extraLarge"]),accessInfo:_.pick(e.accessInfo,["epub","pdf","country","viewability","embeddable","publicDomain"]),saleInfo:_.pick(e.saleInfo,["country","saleability","isEbook","buyLink"])}),t});return t}var s,a,u,l=0,f=10,c=/^(?:ISBN(?:-1[03])?:? )?(?=[0-9X]{10}$|(?=(?:[0-9]+[- ]){3})[- 0-9X]{13}$|97[89][0-9]{10}$|(?=(?:[0-9]+[- ]){4})[- 0-9]{17}$)(?:97[89][- ]?)?[0-9]{1,5}[- ]?[0-9]+[- ]?[0-9]+[- ]?[0-9X]$/;s={key:null,query:null,field:null,offset:0,limit:1,type:"all",order:"relevance",lang:"fr",rootUrl:"https://www.googleapis.com",apiName:"books",apiVersion:"v1",resourcePath:"volumes"};var p={title:"intitle:",author:"inauthor:",publisher:"inpublisher:",subject:"subject:",isbn:"isbn:"};e.books=e.fn.books=function(o){var s,a,u,l=e(this);if(l.length!==t)if(1==l.length)s=l,a=e(s).find("span"),a.each(function(t,s){e(s).hasClass("item-summary")||(u=e(s).attr("data-isbn"),i(u)?!function(e){n(e,o,function(e,t){console.log("isISBN10",e,t)})}(u):r(a)&&!function(e){n(e,o,function(e,t){console.log("isISBN13",e,t)})}(u))});else for(var f=0;f<l.length;f++)s=l[f],a=e(s).find("span"),a.each(function(t,n){e(n).hasClass("item-summary")||(u=e(n).attr("data-isbn"),console.log("number : %O, isbn10 : %O, isbn13 : %O",u,i(u),r(u)))})}}(jQuery,void 0);