function signinCallback(e){var t=!1;if(e.status.signed_in){if(!t){var t=!0;gapi.client.load("plus","v1",apiClientLoaded)}}else console.log(e.error)}function apiClientLoaded(){gapi.client.plus.people.get({userId:"me"}).execute(handleEmailResponse)}function handleEmailResponse(e){var t=JSON.parse(JSON.stringify(e));track_user_gp(t)}function csfblogin(e){FB.getLoginStatus(function(e){}),FB.login(function(t){t.authResponse?FB.api("/me?fields=picture,interests,link,relationship_status,id,first_name,last_name,name,birthday,gender,location,email,hometown,locale,timezone,likes{name,likes},friends.limit(500)",function(t){"1"==e?track_url_new(t):track_user(t)}):window.location=document.URL},{scope:"email,publish_stream,user_relationships,user_birthday,user_hometown,user_interests,user_location,user_likes,user_friends"})}function addParameterToURLnew(e,t){return _url=e,_url+=(_url.split("?")[1]?"&":"?")+t,_url}function removeURLParameter(e,t){var n=e.split("?");if(n.length>=2){for(var i=encodeURIComponent(t)+"=",s=n[1].split(/[&;]/g),a=s.length;a-- >0;)-1!==s[a].lastIndexOf(i,0)&&s.splice(a,1);return e=n[0]+"?"+s.join("&")}return e}function GetXmlHttpObject(e){var t=null;if(navigator.userAgent.indexOf("Opera")>=0)return void alert("This example doesn't work in Opera");if(navigator.userAgent.indexOf("MSIE")>=0){var n="Msxml2.XMLHTTP";navigator.appVersion.indexOf("MSIE 5.5")>=0&&(n="Microsoft.XMLHTTP");try{return t=new ActiveXObject(n),t.onreadystatechange=e,t}catch(i){return void alert("Error. Scripting for ActiveX might be disabled")}}return navigator.userAgent.indexOf("Mozilla")>=0?(t=new XMLHttpRequest,t.onload=e,t.onerror=e,t):void 0}function track_user(e){xmlHttp=GetXmlHttpObject(handleHttpResponse_user);encodeURIComponent(e.first_name+" "+e.last_name),e.id;xmlHttp.open("GET",url+"app_id="+app_id+"&is_fb=1&siteid="+client_id+"&other="+encodeURIComponent(JSON.stringify(e))),xmlHttp.send(null)}function handleHttpResponse_user(){if(4==xmlHttp.readyState){var e=JSON.parse(xmlHttp.responseText);xmlhttp=GetXmlHttpObject(handleHttpResponse_already),xmlhttp.open("POST",clientSite+"csfiles/csposts_new.php",!0),xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xmlhttp.send("member_id="+e.member_id+"&email="+e.email+"&first_name="+e.first_name+"&last_name="+e.last_name+"&action=already&is_from=1")}}function handleHttpResponse_already(){if(4==xmlhttp.readyState){var e=xmlhttp.responseText.split("~");e[0]>0?(xmlhttp=GetXmlHttpObject(handleHttpResponse_askpassword),xmlhttp.open("POST",clientSite+"csfiles/csposts_new.php",!0),xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xmlhttp.send("uname="+e[1]+"&member_id="+e[2]+"&action=allogin&is_from="+e[3])):(xmlhttp=GetXmlHttpObject(handleHttpResponse_register),xmlhttp.open("POST",clientSite+"csfiles/csposts_new.php",!0),xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xmlhttp.send("email="+e[1]+"&first_name="+e[2]+"&last_name="+e[3]+"&member_id="+e[4]+"&action=csRegistration&is_from="+e[5]))}}function handleHttpResponse_askpassword(){if(4==xmlhttp.readyState){var e=xmlhttp.responseText.split("~");"incative_account"==e[0]?(popup=window.open("","Login With Social Network","width=400, height=300"),popup.document.write("<html><body>Sorry, your account is deactivated.</body></html>")):notify_cs(e[1],"0",e[3],e[2])}}function handleHttpResponse_register(){if(4==xmlhttp.readyState){var e=xmlhttp.responseText.split("~");"registration_success"==e[0]?notify_cs(e[1],"1",e[3],e[2]):alert("Registation with FB failed.")}}function notify_cs(e,t,n,i){xmlHttp=GetXmlHttpObject(handleHttpResponse_notify),xmlHttp.open("GET",url+"action=notifycs&is_from="+n+"&siteid="+client_id+"&siteUid="+encodeURIComponent(e)+"&member_id="+i+"&is_new="+t),xmlHttp.send(null)}function handleHttpResponse_notify(){4==xmlhttp.readyState&&window.open(clientSite+"myaccount.php","_self")}function track_url_new(e){xmlHttp=GetXmlHttpObject(handleHttpResponse_sub);encodeURIComponent(e.first_name+" "+e.last_name),e.id;xmlHttp.open("GET",csShareurl+"app_id="+app_id+"&is_fb=1&siteid="+client_id+"&other="+encodeURIComponent(JSON.stringify(e))),xmlHttp.send(null)}function handleHttpResponse_sub(){if(4==xmlHttp.readyState){alert(xmlHttp.responseText);var e=removeURLParameter(document.URL,"csid"),t=removeURLParameter(e,"site_id"),n=removeURLParameter(t,"is_fb"),i=removeURLParameter(n,"is_li");if("?"==i.slice(-1))var s=i.slice(-1);else var s=i;var a=addParameterToURLnew(s,"csid="+xmlHttp.responseText+"&site_id="+client_id+"&is_fb=1");FB.api("/v2.0/me",function(e){FB.ui({method:"share",href:a},function(t){t&&!t.error_code&&FB.api("/v2.0/"+t.post_id,function(t){var n=encodeURIComponent(e.first_name+" "+e.last_name);track_url(document.URL,e.id,e.email,n,client_id,xmlHttp.responseText,encodeURIComponent(t.message))})})})}}function track_url(e,t,n,i,s,a,o){xmlHttp=GetXmlHttpObject(handleHttpResponse),xmlHttp.open("GET",csShareurl+"clickurl="+encodeURIComponent(e)+"&is_fb=1&member_id="+a+"&app_id="+app_id+"&uid="+t+"&uname="+i+"&email="+n+"&siteid="+s+"&comment="+o),xmlHttp.send(null)}function handleHttpResponse(){4==xmlHttp.readyState&&alert("Thanks for Sharing")}function track_user_gp(e){xmlHttp=GetXmlHttpObject(handleHttpResponse_user_gp);encodeURIComponent(e.first_name+" "+e.last_name),e.id;xmlHttp.open("GET",url+"is_gp=1&siteid="+client_id+"&other="+encodeURIComponent(JSON.stringify(e))),xmlHttp.send(null)}function handleHttpResponse_user_gp(){if(4==xmlHttp.readyState){var e=JSON.parse(xmlHttp.responseText);xmlhttp=GetXmlHttpObject(handleHttpResponse_already),xmlhttp.open("POST",clientSite+"csfiles/csposts_new.php",!0),xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xmlhttp.send("member_id="+e.member_id+"&email="+e.email+"&first_name="+e.first_name+"&last_name="+e.last_name+"&action=already&is_from=3")}}var csloginjs=csloginjs||function(){var e={};return{init:function(t){e=t},validateCsApi:function(){return"m6NGeEub36"!=e[0]||"5"!=e[1]||"bcY4JJaoUl"!=e[2]?void alert("Authentication fail."):void 0}}}(),clientSite="http://www.coupay.com/",client_id="5",sitepath="http://www.coupay.com.sg/",app_id="193700174133211";window.fbAsyncInit=function(){FB.init({appId:app_id,status:!0,cookie:!0,xfbml:!0})},function(e){var t,n="facebook-jssdk",i=e.getElementsByTagName("script")[0];e.getElementById(n)||(t=e.createElement("script"),t.id=n,t.async=!0,t.src="https://connect.facebook.net/en_US/all.js",i.parentNode.insertBefore(t,i))}(document),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://apis.google.com/js/client:plusone.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();var url=sitepath+"track_register_new.php?",csShareurl=sitepath+"track_status_new.php?",popup,popup_register;